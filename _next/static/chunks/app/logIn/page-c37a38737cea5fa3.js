(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[672],{1345:(e,t,a)=>{"use strict";a.d(t,{CS:()=>n,Lx:()=>u,wS:()=>o,zJ:()=>l});var r=a(23464);let s="https://script.google.com/macros/s/AKfycbyPcd7XZSeUUoNvZTKJtBYgzgDyh1rB3fUXRMNxo0A38yg-FM2AzvYBcAd60jyA2hEZ/exec",n=async e=>{let t=await r.A.get(s,{params:{user_id:e}});if(!Array.isArray(t.data))throw Error("Unexpected response format");return t.data},o=async e=>(await r.A.post(s,e,{headers:{"Content-Type":"text/plain"}})).data,l=async e=>(await r.A.post(s,e,{headers:{"Content-Type":"text/plain"}})).data,u=async e=>(await r.A.post(s,e,{headers:{"Content-Type":"text/plain"}})).data},35695:(e,t,a)=>{"use strict";var r=a(18999);a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}})},40283:(e,t,a)=>{"use strict";a.d(t,{A:()=>l,O:()=>o});var r=a(95155),s=a(12115);let n=(0,s.createContext)(void 0),o=e=>{let{children:t}=e,[a,o]=(0,s.useState)(!1),[l,u]=(0,s.useState)({isAuthenticated:!1,userId:null,username:null});(0,s.useEffect)(()=>{let e=()=>{{let e=localStorage.getItem("user_id"),t=localStorage.getItem("username");e&&t?u({isAuthenticated:!0,userId:e,username:t}):u({isAuthenticated:!1,userId:null,username:null})}};return e(),o(!0),window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}},[]);let i={...l,isInitialized:a,login:(e,t)=>{try{localStorage.setItem("user_id",e),localStorage.setItem("username",t),u({isAuthenticated:!0,userId:e,username:t}),window.dispatchEvent(new Event("storage"))}catch(e){throw console.error("登入時出錯:",e),e}},logout:()=>{try{localStorage.removeItem("user_id"),localStorage.removeItem("username"),u({isAuthenticated:!1,userId:null,username:null}),window.dispatchEvent(new Event("storage"))}catch(e){throw console.error("登出時出錯:",e),e}}};return(0,r.jsx)(n.Provider,{value:i,children:t})},l=()=>{let e=(0,s.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},51418:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var r=a(95155),s=a(12115),n=a(35695),o=a(40283),l=a(1345);function u(){let e=(0,n.useRouter)(),{login:t}=(0,o.A)(),[a,u]=(0,s.useState)(""),[i,c]=(0,s.useState)(""),[d,m]=(0,s.useState)(""),[h,p]=(0,s.useState)(!1),v=async r=>{r.preventDefault(),p(!0),m("");try{let r=await (0,l.Lx)({action:"login",username:a,password:i});r.success?(t(r.user_id,r.username),e.push("/ytMusic")):m(r.message||"登入失敗，請確認帳號密碼")}catch(e){console.error("登入錯誤:",e),m("登入失敗：伺服器錯誤")}finally{p(!1)}};return(0,r.jsxs)("div",{className:"container mt-5",style:{maxWidth:"400px"},children:[(0,r.jsx)("h2",{className:"mb-4 text-center",children:"登入"}),(0,r.jsxs)("form",{onSubmit:v,children:[(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("label",{htmlFor:"username",className:"form-label",children:"帳號"}),(0,r.jsx)("input",{type:"text",className:"form-control",id:"username",value:a,onChange:e=>u(e.target.value),required:!0})]}),(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("label",{htmlFor:"password",className:"form-label",children:"密碼"}),(0,r.jsx)("input",{type:"password",className:"form-control",id:"password",value:i,onChange:e=>c(e.target.value),required:!0})]}),d&&(0,r.jsx)("div",{className:"alert alert-danger",children:d}),(0,r.jsx)("button",{type:"submit",className:"btn btn-primary w-100",disabled:h,children:h?"登入中...":"登入"})]})]})}},92955:(e,t,a)=>{Promise.resolve().then(a.bind(a,51418))}},e=>{var t=t=>e(e.s=t);e.O(0,[464,441,684,358],()=>t(92955)),_N_E=e.O()}]);